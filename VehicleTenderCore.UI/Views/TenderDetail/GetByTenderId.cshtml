@using System.Runtime.Serialization
@using Microsoft.AspNetCore.Http
@model VehicleTenderCore.Entities.View.TenderDetail.TenderDetailListVM

@using VehicleTenderCore.UI.Extensions

@inject IHttpContextAccessor HttpContextAccessor

@{
	var user = HttpContextAccessor.HttpContext?.Session.MySessionGet<SessionVMForUser>("user");
}

<div style="margin-top:125px;"></div>

<div class="mb-5">
	<div class="d-flex justify-content-around">
		<label asp-for="TenderName" class="text-decoration-underline font-weight-bold text-uppercase"></label>
		<label asp-for="StartDateTime" class="text-decoration-underline font-weight-bold text-uppercase"></label>
		<label asp-for="EndDateTime" class="text-decoration-underline font-weight-bold text-uppercase"></label>
	</div>
	<div class="d-flex justify-content-around">
		<label>@Model.TenderName</label>
		<label>@Model.StartDateTime</label>
		<label>@Model.EndDateTime</label>
	</div>
</div>

@{
	int sayac = 0;
}

@foreach (var item in Model.TenderAndVehicleDetailList)
{
	<div class="row mb-5">
		<div id="carouselExampleControls@(sayac)" class="carousel slide col-md-7" data-ride="carousel">
			<div class="carousel-inner">
				@foreach (var image in item.VehicleImages)
				{
					<div class="carousel-item @if (image == item.VehicleImages[0]) {
		    <text>active</text>
 }">
										<img class="d-block w-100" src="http://localhost:33901/@image" alt="First slide style=" height="400px;">
									</div>
				}
				@if (item.VehicleImages.Count == 0)
				{
					<div class="carousel-item active">
						<img class="d-block w-100" src="/TemplateContent/img/DbAddedImg/default_car.jpg" alt="First slide style=" height="400px;">
					</div>
				}
			</div>
			<a class="carousel-control-prev" href="#carouselExampleControls@(sayac)" role="button" data-slide="prev">
				<span class="carousel-control-prev-icon" aria-hidden="true"></span>
				<span class="sr-only">Previous</span>
			</a>
			<a class="carousel-control-next" href="#carouselExampleControls@(sayac++)" role="button" data-slide="next">
				<span class="carousel-control-next-icon" aria-hidden="true"></span>
				<span class="sr-only">Next</span>
			</a>
		</div>

		<div class="col-md-4 border p-3">
			<div class="d-flex flex-column bd-highlight mb-3">
				<div>
					<div class="d-flex justify-content-between bd-highlight mb-5">
						<pre>Araç Plaka</pre>
						<p style="font-size:30px;">@item.LicencePlate</p>
					</div>
					<div class="d-flex justify-content-between bd-highlight mb-5">
						<pre>İhale Fiyatı</pre>
						<p style="font-size:30px;">@item.StartPrice</p>
					</div>
					<div class="d-flex justify-content-between bd-highlight mt-5">
						<pre>Teklif Edilen Fiyat</pre>
						<p style="font-size:30px;">@item.OfferPrice</p>
					</div>
				</div>
				<div class="mt-5">
					<form asp-controller="TenderHistory" asp-action="Add" method="post">
						<input type="hidden" name="TenderDetailId" value="@item.TenderDetailId" />
						@if (Model.UserId != user.UserId)
						{
							<div class="d-flex justify-content-between bd-highlight mb-3">
								<pre>Teklif Ver</pre>
								<input name="Price" type="number" class="form-control col-md-6" min="@((int)item.OfferPrice)" required="true" />
							</div>
							<div class="d-flex justify-content-end bd-highlight mb-3">
								<input type="submit" class="btn btn-success col-md-6" value="Teklif Ver" />
							</div>
						}
						else
						{
							<div class="d-flex justify-content-end bd-highlight mb-3">
								<a href="@Url.Action("GetForCorporate","TenderHistory",new {@tenderId=item.TenderDetailId})" class="btn btn-primary col-md-6">İhale Detay</a>
							</div>
						}
					</form>
				</div>
			</div>
		</div>
	</div>

}
